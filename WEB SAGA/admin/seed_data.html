<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Seed Data - WEBSAGA</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="p-5 text-center">
    <h1>Database Seeder</h1>
    <p class="mb-4">Click below to populate the database with 10 Courses, Units, and Questions.</p>
    <button class="btn btn-primary btn-lg" onclick="seedData()">Seed Database</button>
    <div id="status" class="mt-3"></div>

    <script src="../js/db.js"></script>
    <script>
        function seedData() {
            const status = document.getElementById('status');
            status.innerHTML = "Seeding...";

            try {
                // 1. COURSES
                const courses = [
                    { id: 1, name: "Data Structures", code: "CS101", credits: 4, type: "Core", status: "Active" },
                    { id: 2, name: "Algorithms", code: "CS102", credits: 4, type: "Core", status: "Active" },
                    { id: 3, name: "Operating Systems", code: "CS103", credits: 3, type: "Core", status: "Active" },
                    { id: 4, name: "Database Management", code: "CS104", credits: 4, type: "Core", status: "Active" },
                    { id: 5, name: "Computer Networks", code: "CS105", credits: 3, type: "Core", status: "Active" },
                    { id: 6, name: "Software Engineering", code: "CS106", credits: 3, type: "Core", status: "Active" },
                    { id: 7, name: "Web Technologies", code: "CS107", credits: 3, type: "Elective", status: "Active" },
                    { id: 8, name: "Machine Learning", code: "CS108", credits: 4, type: "Elective", status: "Active" },
                    { id: 9, name: "Cloud Computing", code: "CS109", credits: 3, type: "Elective", status: "Active" },
                    { id: 10, name: "Cyber Security", code: "CS110", credits: 3, type: "Elective", status: "Active" }
                ];
                localStorage.setItem(DB.KEYS.COURSES, JSON.stringify(courses));

                // 2. UNITS (5 per course)
                let units = [];
                let unitId = 1;
                courses.forEach(c => {
                    for (let i = 1; i <= 5; i++) {
                        units.push({
                            id: unitId++,
                            number: `Unit ${toRoman(i)}`,
                            name: `Unit ${i} Name for ${c.code}`,
                            courseId: c.id,
                            description: `Description for Unit ${i} of ${c.name}`,
                            status: "active"
                        });
                    }
                });
                localStorage.setItem('wsg_units', JSON.stringify(units));

                // 3. QUESTIONS (5 per unit = 25 per course -> 250 total)
                let questions = [];
                let qId = 1;
                const difficulties = ['Easy', 'Medium', 'Hard'];
                const blooms = ['Remember', 'Understand', 'Apply', 'Analyze', 'Evaluate'];
                const cos = ['CO1', 'CO2', 'CO3', 'CO4', 'CO5'];

                units.forEach(u => {
                    for (let i = 0; i < 5; i++) {
                        questions.push({
                            id: qId++,
                            text: `This is a sample question ${i + 1} for ${u.name} in ${u.number}?`,
                            courseId: u.courseId,
                            unitId: u.id,
                            unitName: u.number, // Snapshot
                            difficulty: difficulties[i % 3], // Rotate
                            bloom: blooms[i % 5], // Rotate
                            co: cos[i % 5], // Rotate
                            marks: (i % 3 === 0) ? 2 : (i % 3 === 1) ? 5 : 10, // 2, 5, 10 pattern
                            type: 'Descriptive'
                        });
                    }
                });
                localStorage.setItem(DB.KEYS.QUESTIONS, JSON.stringify(questions));

                status.innerHTML = `<div class="alert alert-success">Success! Seeded: <br> 10 Courses <br> ${units.length} Units <br> ${questions.length} Questions</div>`;

            } catch (e) {
                console.error(e);
                status.innerHTML = `<div class="alert alert-danger">Error: ${e.message}</div>`;
            }
        }

        function toRoman(num) {
            const roman = ["I", "II", "III", "IV", "V"];
            return roman[num - 1] || num;
        }
    </script>
</body>

</html>